# Event Drop | CKBULL Hackathon ðŸ’»

Event Drop allows event creators to create unique experiences for their attendees. Attendees will be able to remember and prove their participation in amazing events.

POAP (Proof-of-Attendance) is a protocol that has become very popular in recent years, allowing event attendees to have an NFT as a symbol of participation, referring to badges or participation certificates.

Event Drop harnesses the potential of Common Knowledge Base, to allow event organizers to award POAPs as a symbol of participation to their attendees, thus improving their experience and providing an incentive to participate.

Event Drop consists of three sections:

- Minting & Organizer Viewer page
- Claim page
- NFT Viewer page

Also for easy user identification and management we use [CKBull signer API](https://docs.ckbull.app/) to integrate CKBull Wallet.

## This monorepo has 3 sections

### Frontend

We use nextJS/TS to build our frontend.

in order to run in dev:

**Prerequisites**

- NodeJS `v16.20.1`
- npm `v8.19.4`
- Yarn `v1.22.19`


```sh
$ cd frontend && yarn
```

```sh
$ yarn dev
```

Then open [http://localhost:3000](http://localhost:3000)

### Backend

**Prerequisites**

- NodeJS `v16.20.1`
- npm `v8.19.4`
- Yarn `v1.22.19`
- PostgreSQL `v15`


**Run local**

1. First you need to create 2 tables in your local postgreSQL with them corresponding index

creating `users` table

```sql
-- DDL generated by Postico 2.0.4
-- Not all database features are supported. Do not use for backup.

-- Table Definition ----------------------------------------------

CREATE TABLE users (
    id integer GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    uuid text UNIQUE,
    address text UNIQUE,
    email text UNIQUE,
    created_at timestamp with time zone DEFAULT now(),
    updated_at timestamp with time zone,
    deleted_at timestamp with time zone
);

-- Indices -------------------------------------------------------

CREATE UNIQUE INDEX users_pkey ON users(id int4_ops);
CREATE UNIQUE INDEX users_uuid_key ON users(uuid text_ops);
CREATE UNIQUE INDEX users_address_key ON users(address text_ops);
CREATE UNIQUE INDEX users_email_key ON users(email text_ops);

```

creating `events` table

```sql
-- DDL generated by Postico 2.0.4
-- Not all database features are supported. Do not use for backup.

-- Table Definition ----------------------------------------------

CREATE TABLE events (
    id integer GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    name text,
    description text,
    links text,
    start_date timestamp with time zone,
    end_date timestamp with time zone,
    event_type integer DEFAULT 1,
    unlockable_content text,
    transferable integer DEFAULT 1,
    visibility integer DEFAULT 1,
    poap_cid text,
    created_at timestamp with time zone DEFAULT now(),
    updated_at timestamp with time zone,
    deleted_at timestamp with time zone,
    creator_id integer DEFAULT 2 REFERENCES users(id)
);

-- Indices -------------------------------------------------------

CREATE UNIQUE INDEX events_pkey ON events(id int4_ops);

```

Keep your postgreSQL local server running up.


2. Edit env file

Rename the env file `backend/example.env` to `backend/.env`. And add the next info:

```
PORT=5001
DB_PORT=5432
CKBULL_API_KEY='YOUR_CKBULL_API_KEY'
CKBULL_API_SECRET='YOUR_CKBULL_API_SECRET'
JWT_SECRET='YOUR_SECRET_JSONWEBTOKEN'
POSTGRES_USER='YOUR_POSTGRES_USER'
POSTGRES_HOST='localhost'
POSTGRES_DATABASE='YOUR_POSTGRES_DATABASE_NAME'
POSTGRES_PASSWORD='YOUR_POSTGRES_PASSWORD_IF_NOT_SETTED_EMPTY_STRING'
```

3. Run Express Server

Install
```sh
$ cd backend && npm install
```

run

```sh
$ npm start
```

4. Interact with the REST API

**Request CKBULL Signin code**
- `GET` http://localhost:5001/api/auth/request/signin


**Get CKBULL Signin status**
- `GET` http://localhost:5001/api/auth/request/status?code=<token_code>

**Get user drops**
`GET` http://localhost:5001/api/drop?creator_id=<creator_id>

**Create Drop**
`POST` http://localhost:5001/api/drop

example post json body

```JSON
{
	"name": "Event Drop",
	"description": "",
	"links": "",
	"start_date": 1693775059,
	"end_date": 1696129459,
	"event_type": 1,
	"unlockable_content": "",
	"transferable": 1,
	"visibility": 1,
	"poap_cid": "QmQhd6qEsLtY1zQKG6DpNkQBP1GUq96coKeCr3BtT4BYSH",
	"creator_id": 1
}
``````

### Smart Contracts

TO BE IMPLEMENTED